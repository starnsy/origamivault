<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Encrypt Content with Password and get QR code</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 16px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        input, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        #qrcode {
            margin-top: 30px;
            text-align: center;
            display: none;
        }

        #qrcode canvas, #qrcode img {
            margin: 0 auto;
            border-radius: 8px;
        }

        .qr-title {
            margin-bottom: 15px;
            color: #333;
            font-weight: 600;
            font-size: 18px;
        }

        .print-instruction {
            margin-top: 20px;
            text-align: center;
            color: #555;
            font-size: 16px;
        }

        .decrypt-link {
            margin-top: 15px;
            text-align: center;
        }

        .decrypt-link a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
        }

        .decrypt-link a:hover {
            text-decoration: underline;
        }

        .qr-container {
            display: flex;
            gap: 30px;
            margin-top: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .qr-item {
            flex: 1;
            min-width: 280px;
            max-width: 350px;
            text-align: center;
        }

        .qr-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .qr-description {
            font-size: 13px;
            color: #666;
            margin-top: 10px;
            line-height: 1.4;
        }

        .explanation {
            margin-top: 25px;
            padding: 15px;
            background: #f0f4ff;
            border-radius: 8px;
            color: #333;
            font-size: 14px;
            line-height: 1.6;
            text-align: left
        }

        .explanation strong {
            color: #667eea;
        }

        .print-button {
            margin-top: 25px;
            width: 100%;
            background: #28a745;
        }

        .print-button:hover {
            background: #218838;
        }

        .link {
            text-align: center;
            margin-top: 20px;
        }

        .link a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }

        .link a:hover {
            text-decoration: underline;
        }

        .footer {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
        }

        .footer a {
            color: white;
            text-decoration: none;
            font-weight: 600;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        @media print {
            @page {
                size: portrait;
            }
            .print-button {
                display: none;
            }
            .qr-title {
                display: none;
            }
            .footer {
                display: none;
            }
            body {
                background: white;
            }
            .container {
                box-shadow: none;
            }
            .qr-container {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Encrypt Content</h1>

        <div id="formSection">
            <div class="form-group">
                <label for="content">Content to Encrypt</label>
                <textarea id="content" placeholder="Enter your secret message..."></textarea>
            </div>

            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="Enter a strong password" autocomplete="off" data-lpignore="true" data-form-type="other">
            </div>

            <button onclick="encryptAndGenerateQR()">Encrypt & Generate QR Code</button>

            <div class="link">
                <a href="decrypt.html">Go to Decrypt Page</a>
            </div>
        </div>

        <div id="qrcode"></div>
    </div>

    <div class="footer">
        <a href="https://github.com/declegacy/secretqr" target="_blank">SecretQR</a> is open source project
    </div>

    <script>
        function encryptAndGenerateQR() {
            const content = document.getElementById('content').value;
            const password = document.getElementById('password').value;

            if (!content) {
                alert('Please enter content to encrypt');
                return;
            }

            if (!password) {
                alert('Please enter a password');
                return;
            }

            // Encrypt the content using AES
            const encrypted = CryptoJS.AES.encrypt(content, password).toString();

            // Change the title
            document.querySelector('h1').textContent = 'Encrypted content';

            // Hide the form section
            document.getElementById('formSection').style.display = 'none';

            // Clear previous QR code if any
            const qrcodeDiv = document.getElementById('qrcode');
            qrcodeDiv.innerHTML = `
                <div class="qr-title">Print these QR codes</div>

                <div class="explanation">
                    These two QR codes are needed to decrypt the content later. Scan the first QR code to open the decrypt page, and then scan the second QR code on that page to retrieve the encrypted data. 
                </div>

                <div class="qr-container">
                    <div class="qr-item">
                        <div class="qr-label">1. Decrypt Link</div>
                        <div id="qrLinkContainer"></div>
                        <div class="qr-description">Scan to open decryptor in your web browser: https://declegacy.github.io/secretqr/decrypt.html</div>
                    </div>

                    <div class="qr-item">
                        <div class="qr-label">2. Encrypted Data</div>
                        <div id="qrDataContainer"></div>
                        <div class="qr-description">Scan on decrypt page</div>
                    </div>
                </div>

                <button class="print-button" onclick="window.print()">Print QR Codes</button>
            `;
            qrcodeDiv.style.display = 'block';

            // Generate QR code for decrypt link
            new QRCode(document.getElementById('qrLinkContainer'), {
                text: 'https://declegacy.github.io/secretqr/decrypt.html',
                width: 200,
                height: 200,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.M
            });

            // Generate QR code for encrypted data
            new QRCode(document.getElementById('qrDataContainer'), {
                text: encrypted,
                width: 200,
                height: 200,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });
        }
    </script>
</body>
</html>
